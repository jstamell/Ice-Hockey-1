g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals),
color = "yellow", alpha = .9)+ geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color = "blue", alpha = .5) + scale_size(name="Number of goals")
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals),
color = "yellow", alpha = .9)+ geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color = "red", alpha = .5) + scale_size(name="Number of goals")
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
color = "yellow", alpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color = away.goals),
alpha = .5) + scale_size(name="Number of goals")
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
color = "yellow", alpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color = away.goals),
alpha = .5)
g <- ggplot() +
geom_polygon( data=MainStates, aes(x=long, y=lat, group=group),
color="lightgreen", fill="lightgreen" )
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
color = "yellow", alpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color = away.goals),
alpha = .5)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color="Home goals"),
color = "yellow", alpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color = away.goals),
alpha = .5)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
calpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color = away.goals),
alpha = .5)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color = away.goals),
alpha = .5)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color = away.goals),
alpha = .5, shape=17)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color = away.goals),
alpha = .5)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9) +
geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9) + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9)
g <- ggplot() +
geom_polygon( data=MainStates, aes(x=long, y=lat, group=group),
color="lightgreen", fill="lightgreen" )
g
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color=away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
color = 'red', alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='yellow',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
color = 'red', alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9)
g <- ggplot() +
geom_polygon( data=MainStates, aes(x=long, y=lat, group=group),
color="lightyellow", fill="lightyellow" )
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals^2),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, size = home.goals, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals, shape=10),
alpha = .9)
View(arenaCities)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=as.factor(home.goals)),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals, color='yellow'),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='yellow',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='lightred',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
color='blue',alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_point() +geom_text(aes(x=long, y=lat, label=venue.name),hjust=0, vjust=0)
g + ggplot(data=arenaCities) geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point( aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_point(aes(x=long, y=lat, label=venue.name),hjust=0, vjust=0)
g + ggplot(data=arenaCities) + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point( aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_point(aes(x=long, y=lat, label=venue.name),hjust=0, vjust=0)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_point(data=arenaCities) +geom_text(aes(x=long, y=lat, label=venue.name),hjust=0, vjust=0)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_point(data=arenaCities, aes(x=long, y=lat, label=venue.name),hjust=0, vjust=0)
g + geom_point(data=arenaCities, aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(data=arenaCities, aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_point(data=arenaCities, aes(x=long, y=lat, label=venue.name))
g <- ggplot(data=arenaCities) +
geom_polygon( data=MainStates, aes(x=long, y=lat, group=group),
color="lightyellow", fill="lightyellow" )
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_point(data=arenaCities, aes(x=long, y=lat, label=venue.name))
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text(aes(x=long, y=lat, label=venue.name), hjust=0, vjust=0)
alpha = .9) + geom_text(aes(x=long, y=lat, label=ifelse(PTS>24,as.character(venue.name),''), hjust=0, vjust=0)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text(aes(x=long, y=lat, label=ifelse(PTS>24,as.character(venue.name),'')), hjust=0, vjust=0)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text(aes(x=long, y=lat, label=venue.name), hjust=0, vjust=0)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text(aes(x=long, y=lat, label=name), hjust=0, vjust=0)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text(aes(x=long, y=lat, label=county.etc), hjust=0, vjust=0)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text(aes(x=long, y=lat, label=country.etc), hjust=0, vjust=0)
library(ggrepel)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=venue.name), hjust=0, vjust=0)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=10)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=1)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="sqrt") + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="sqrt", guide='legend') + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="sqre", guide='legend') + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="sq", guide='legend') + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="exp", guide='legend') + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="sqrt", guide='legend') + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="log10", guide='legend') + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="asn", guide='legend') + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + scale_size_identity(trans="hms", guide='legend') + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
runApp()
dataStatYear <- vF_game_info[vF_game_info$season == 2018]
df <- dataStatYear[,c('name','home.win','away.win','home.goals','away.goals')]
dfGroupByArena <- aggregate(. ~ name , df, sum)
colnames(dfGroupByArena)[1] <- 'venue.name'
dfGroupByArena <- merge(dfGroupByArena, vF_teams_DT[,c('venue.name', 'venue.city', 'locationName', 'division.name')], by = 'venue.name')
colnames(dfGroupByArena)[6] <- 'name'
us_cities <- us.cities
us_cities$name <- str_sub(us_cities$name, end = -4)
arenaCities <- merge(us_cities, dfGroupByArena, by = 'name')
MainStates <- map_data("state")
ggplot(data=arenaCities) +
geom_polygon( data=MainStates, aes(x=long, y=lat, group=group),
color="lightyellow", fill="lightyellow" ) +
geom_point(aes(x=long, y=lat, size = away.goals), color='violet',alpha = .5) +
geom_point(aes(x=long, y=lat, color= home.goals), alpha = .9) +
geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
runApp()
df <- dataStatYear[,c('name','home.win','away.win','home.goals','away.goals')]
dfGroupByArena <- aggregate(. ~ name , df, sum)
colnames(dfGroupByArena)[1] <- 'venue.name'
dfGroupByArena <- merge(dfGroupByArena, vF_teams_DT[,c('venue.name', 'venue.city', 'locationName', 'division.name')], by = 'venue.name')
colnames(dfGroupByArena)[6] <- 'name'
us_cities <- us.cities
us_cities$name <- str_sub(us_cities$name, end = -4)
arenaCities <- merge(us_cities, dfGroupByArena, by = 'name')
MainStates <- map_data("state")
ggplot(data=arenaCities) + geom_polygon( data=MainStates, aes(x=long, y=lat, group=group),
color="lightyellow", fill="lightyellow" ) + geom_point(aes(x=long, y=lat, size = away.win),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color= home.win),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name),
hjust=0, vjust=0, size=2.5)
g <- ggplot(data=arenaCities) +
geom_polygon( data=MainStates, aes(x=long, y=lat, group=group),
color="lightyellow", fill="lightyellow" )
g + geom_point(aes(x=long, y=lat, size = away.goals),
color='violet',alpha = .5) + geom_point(aes(x=long, y=lat, color=home.goals),
alpha = .9) + geom_text_repel(aes(x=long, y=lat, label=name), hjust=0, vjust=0, size=2.5)
us.cities$name[1:5]
dataStatYear <- vF_game_info[vF_game_info$season == 2018]
load("~/Desktop/Courses/EDAV/Ice-Hockey/data/2019-11-26_nhl-cleaned-data.RData")
dataStatYear <- vF_game_info[vF_game_info$season == 2018]
runApp()
dataStatYear <- vF_game_info[vF_game_info$season == 2018]
df <- dataStatYear[,c('name','home.win','away.win','home.goals','away.goals')]
dfGroupByArena <- aggregate(. ~ name , df, sum)
colnames(dfGroupByArena)[1] <- 'venue.name'
dfGroupByArena <- merge(dfGroupByArena, vF_teams_DT[,c('venue.name', 'venue.city', 'locationName', 'division.name')], by = 'venue.name')
colnames(dfGroupByArena)[6] <- 'name'
us_cities <- us.cities
us_cities$name <- str_sub(us_cities$name, end = -4)
arenaCities <- merge(us_cities, dfGroupByArena, by = 'name')
View(arenaCities)
runApp()
arenaCities %>% gather(key='GoalType', value = 'Goals', home.goals, away.goals)
runApp()
arenaCities <- arenaCities %>%
gather(key='GoalType', value = 'Goals', home.goals, away.goals) %>%
gather(key = 'WinType', value = 'Wins', home.win, away.win)
View(arenaCities)
View(us_cities)
runApp()
x <- c("New York", "Virginia")
state.abb[match(x,state.name)]
runApp()
dfGroupByArena$locationName <- state.abb[match(dfGroupByArena$locationName, state.name)]
colnames(dfGroupByArena)[7] <- 'country.etc'
View(dfGroupByArena)
runApp()
df <- dataStatYear[,c('name','home.win','away.win','home.goals','away.goals')]
dfGroupByArena <- aggregate(. ~ name , df, sum)
colnames(dfGroupByArena)[1] <- 'venue.name'
dfGroupByArena <- merge(dfGroupByArena, vF_teams_DT[,c('venue.name', 'venue.city', 'locationName', 'division.name')], by = 'venue.name')
colnames(dfGroupByArena)[6] <- 'name'
us_cities <- us.cities
us_cities$name <- str_sub(us_cities$name, end = -4)
dfGroupByArena$locationName <- state.abb[match(dfGroupByArena$locationName, state.name)]
View(dfGroupByArena)
df <- dataStatYear[,c('name','home.win','away.win','home.goals','away.goals')]
dfGroupByArena <- aggregate(. ~ name , df, sum)
colnames(dfGroupByArena)[1] <- 'venue.name'
dfGroupByArena <- merge(dfGroupByArena, vF_teams_DT[,c('venue.name', 'venue.city', 'locationName', 'division.name')], by = 'venue.name')
colnames(dfGroupByArena)[6] <- 'name'
us_cities <- us.cities
us_cities$name <- str_sub(us_cities$name, end = -4)
View(dfGroupByArena)
state.abb[match(dfGroupByArena$locationName, state.name)]
View(dfGroupByArena)
state.abb[match('Dallas', state.name)]
View(us_cities)
runApp()
arenaCities %>% distinct(name, .keep_all = FALSE)
arenaCities %>% distinct(name, .keep_all = TRUE)
View(arenaCities)
runApp()
runApp()
runApp()
View(vF_game_info)
View(vF_game_teams_stats)
View(vF_game_shootout_status)
View(vF_game_skater_stats)
View(vF_game_goalie_stats)
View(vF_game_plays)
View(vF_game_teams_stats)
runApp()
runApp()
View(vF_game_info)
View(vF_teams_DT)
teamIds <- vF_teams_DT[long.name %in% c(1,2,3)]$team.id
year <- 2018
upper_lim <- as.numeric(year) +1
upper_lim <- paste0(as.character(upper_lim),'000000')
lower_lim <- as.numeric(year) -1
lower_lim <- paste0( as.character(lower_lim),'999999')
df <- vF_game_teams_stats[team.id %in% teamIds & (as.numeric(game.id) > as.numeric(lower_lim) & as.numeric(game.id) < as.numeric(upper_lim))]
View(df)
teamIds
teamIds <- vF_teams_DT[long.name %in% c('New Jersey Devils', 'Boston Bruins', 'Calgary Flames' )]$team.id
teamIds
upper_lim <- as.numeric(year) +1
upper_lim <- paste0(as.character(upper_lim),'000000')
lower_lim <- as.numeric(year) -1
lower_lim <- paste0( as.character(lower_lim),'999999')
df <- vF_game_teams_stats[team.id %in% teamIds & (as.numeric(game.id) > as.numeric(lower_lim) & as.numeric(game.id) < as.numeric(upper_lim))]
View(df)
runApp()
df <- vF_game_teams_stats[team.id %in% teamIds]
View(df)
str_sub(df$game.id, end=-6)
df$game.id <- sub_str(df$game.id, edn=-7)
df$game.id <- str_sub(df$game.id, edn=-7)
df$game.id <- str_sub(df$game.id, end=-7)
View(df)
View(df)
df %>% group_by(game.id, team.id, HoA) %>% summarise(funs(sum()))
df %>% group_by(game.id, team.id, HoA) %>% summarise(funs(sum))
df %>% group_by(game.id, team.id, HoA) %>% summarise_each(funs(sum))
df <- vF_game_teams_stats[team.id %in% teamIds]
df <- vF_game_teams_stats[team.id %in% teamIds]
df$game.id <- str_sub(df$game.id, end=-7)
df <- as.data.frame(df %>% group_by(game.id, team.id, HoA) %>% summarise_each(funs(sum)))
View(df)
dfHome <- df[df$HoA == 'home']
dfHome <- df[df$HoA == 'home',]
View(dfHome)
dfTotal <- df[, -c('HoA')]
dfTotal <- subset(df, select = -c(away))
dfTotal <- subset(df, select = -c('away'))
dfTotal <- subset(df, select = -c('HoA'))
df[,!c('HoA')]
df[,!(columns(df) %in% c('HoA'))]
df[,!(colnames(df) %in% c('HoA'))]
df <- df[,c('game.id', "team.id", 'HoA', 'won')]
dfHome <- df[df$HoA == 'home',]
dfAway <- df[df$HoA == 'away',]
dfTotal <- df[,!(colnames(df) %in% c('HoA'))]
dfTotal <- aggregate(.~game.id+team.id, dfTotal, sum)
View(dfTotal)
dfTotal %>% spread(key=team.id, value=won)
ggplot(dfTotal, aes(game.id, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
Names=c("Food","Music","People")     # create list of names
data=data.frame(cbind(freq),Names)   # combine them into a data frame
data=data[,c(5,3,1,2,4)]             # sort columns
# melt the data frame for plotting
data.m <- melt(data, id.vars='Names')
library(melt)
library(reshape2)
dfTotal <- melt(dfTotal, id.vars = 'game.id')
ggplot(data=dfTotal, aes(x=game.id, y=value, fill=variable)) +
geom_bar(stat="identity", position=position_dodge())
df <- vF_game_teams_stats[team.id %in% teamIds]
df <- vF_game_teams_stats[team.id %in% teamIds]
df$game.id <- str_sub(df$game.id, end=-7)
df <- as.data.frame(df %>% group_by(game.id, team.id, HoA) %>% summarise_each(funs(sum)))
df <- df[,c('game.id', "team.id", 'HoA', 'won')]
dfHome <- df[df$HoA == 'home',]
dfAway <- df[df$HoA == 'away',]
dfTotal <- df[,!(colnames(df) %in% c('HoA'))]
dfTotal <- aggregate(.~game.id+team.id, dfTotal, sum)
dfTotal <- melt(dfTotal, id.vars = 'game.id')
ggplot(data=dfTotal, aes(x=game.id, y=value, fill=variable)) +
geom_bar(stat="identity", position=position_dodge())
teamIds <- vF_teams_DT[long.name %in% c(input$teamPerf1, input$teamPerf2, input$teamPerf3)]$team.id
df <- vF_game_teams_stats[team.id %in% teamIds]
df <- vF_game_teams_stats[team.id %in% teamIds]
df$game.id <- str_sub(df$game.id, end=-7)
df <- as.data.frame(df %>% group_by(game.id, team.id, HoA) %>% summarise_each(funs(sum)))
df <- df[,c('game.id', "team.id", 'HoA', 'won')]
dfHome <- df[df$HoA == 'home',]
dfAway <- df[df$HoA == 'away',]
dfTotal <- df[,!(colnames(df) %in% c('HoA'))]
View(dfTotal)
dfTotal %>% spread(key = 'team.id', vvalue = 'won')
dfTotal %>% spread(key = 'team.id', value = 'won')
dfTotal %>% spread(key = 'team.id', value = 'won')
dfTotal <- aggregate(.~game.id+team.id, dfTotal, sum)
dfTotal %>% spread(key = 'team.id', value = 'won')
dfTotal <- melt(dfTotal, id.vars = 'game.id')
ggplot(data=dfTotal, aes(x=game.id, y=value, fill=variable)) +
geom_bar(stat="identity", position=position_dodge())
dfTotal
df <- vF_game_teams_stats[team.id %in% teamIds]
df <- vF_game_teams_stats[team.id %in% teamIds]
df$game.id <- str_sub(df$game.id, end=-7)
df <- as.data.frame(df %>% group_by(game.id, team.id, HoA) %>% summarise_each(funs(sum)))
df <- df[,c('game.id', "team.id", 'HoA', 'won')]
dfHome <- df[df$HoA == 'home',]
dfAway <- df[df$HoA == 'away',]
dfTotal <- df[,!(colnames(df) %in% c('HoA'))]
dfTotal <- aggregate(.~game.id+team.id, dfTotal, sum)
dfTotal <- dfTotal %>% spread(key = 'team.id', value = 'won')
dfTotal
melt(dfTotal, id.vars = 'game.id')
dfTotalMelt <- melt(dfTotal, id.vars = 'game.id')
ggplot(data=dfTotalMelt, aes(x=game.id, y=value, fill=variable)) +
geom_bar(stat="identity", position=position_dodge())
ggplot(data=dfTotalMelt, aes(x=game.id, y=value, fill=variable, size=0.25, width=0.8, alpha=0.8)) +
geom_bar(stat="identity", position=position_dodge()) + ylab('Total wins')
ggplot(data=dfTotalMelt, aes(x=game.id, y=value,  size=0.25, width=0.5, alpha=0.8)) +
geom_bar(stat="identity", position=position_dodge()) + ylab('Total wins')
ggplot(data=dfTotalMelt, aes(x=game.id, y=value, fill=variable, size=0.25, width=0.1)) +
geom_bar(stat="identity", position=position_dodge()) + ylab('Total wins')
ggplot(data=dfTotalMelt, aes(x=game.id, y=value, fill=variable, size=0.25, width=0.3)) +
geom_bar(stat="identity", position=position_dodge()) + ylab('Total wins')
ggplot(data=dfTotalMelt, aes(x=game.id, y=value, fill=variable, size=0.25, width=0.4)) +
geom_bar(stat="identity", position=position_dodge()) + ylab('Total wins')
ggplot(data=dfTotalMelt, aes(x=game.id, y=value, fill=variable, size=0.25, width=0.3)) +
geom_bar(stat="identity", position=position_dodge()) + ylab('Total wins') +
scale_fill_manual("legend", values = c(teamIds[1] = "black", teamIds[2] = "orange", teamIds[3] = "blue"))
ggplot(data=dfTotalMelt, aes(x=game.id, y=value, fill=variable, size=0.25, width=0.3)) +
geom_bar(stat="identity", position=position_dodge()) + ylab('Total wins')
ggplot(data=dfTotalMelt, aes(x=game.id, y=value, fill=variable, size=0.25, width=0.3)) +
geom_bar(stat="identity", position=position_dodge()) + ylab('Total wins') +
scale_fill_manual("legend", values = c("black", "orange", "blue"))
runApp()
df <- vF_game_teams_stats[team.id %in% teamIds]
df <- vF_game_teams_stats[team.id %in% teamIds]
df$game.id <- str_sub(df$game.id, end=-7)
df <- as.data.frame(df %>% group_by(game.id, team.id, HoA) %>% summarise_each(funs(sum)))
df <- df[,c('game.id', "team.id", 'HoA', 'won')]
dfHome <- df[df$HoA == 'home',]
dfAway <- df[df$HoA == 'away',]
dfTotal <- df[,!(colnames(df) %in% c('HoA'))]
dfTotal <- aggregate(.~game.id+team.id, dfTotal, sum)
dfTotal
merge(dfTotal, dfHome, by=c('game.id','team.id'))
dfHome
merge(dfTotal, dfHome[,c('game.id','team.id')], by=c('game.id','team.id'))
merge(dfTotal, dfHome[,c('game.id','team.id','won')], by=c('game.id','team.id'))
dfTotal <- merge(dfTotal, dfHome[,c('game.id','team.id','won')], by=c('game.id','team.id'))
dfTotal %>% spread(key = 'team.id', value = c('won.x','won.y'))
dfTotal %>% spread(key = 'team.id', value = c('won.x'))
dfHome
runApp()
View(vF_game_info)
shiny::runApp()
shiny::runApp()
runApp()
test  <- data.frame(person=c("A", "B", "C", "D", "E"),
value1=c(100,150,120,80,150),
value2=c(25,30,45,30,30) ,
value3=c(100,120,150,150,200))
test
melted <- melt(test, "person")
melted
df <- vF_game_teams_stats[team.id %in% c(1,2,3)]
df$game.id <- str_sub(df$game.id, end=-7)
View(df)
df <- as.data.frame(df %>% group_by(game.id, team.id, HoA) %>% summarise_each(funs(sum)))
df <- df[,c('game.id', "team.id", 'HoA', 'won')]
View(df)
melted
ggplot() + geom_bar(data =df, aes(y = won, x = team.id, fill = HoA), stat = "identity", position = 'stack') + theme_bw() + facet_grid(~game.id)
runApp()
df
ggplot() +
geom_bar(data =df, aes(y = won, x = team.id, fill = HoA), stat = "identity", position = 'stack') +
theme_bw() +
facet_grid(~game.id)
runApp()
df <- vF_game_teams_stats[team.id %in% c(1,2,3)]
View(df)
runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
